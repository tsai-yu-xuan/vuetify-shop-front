import{_ as q,E as f,I as C,a7 as F,a6 as I,u as E,o as M,a as B,aa as n,ae as N,b as s,w as o,V as P,ad as c,d as r,aC as R,aA as L,R as g,ac as b,aN as U,F as $,aO as z,aM as A,af as O,ag as T,az as j}from"./index-BBEz_kA-.js";import{c as D,b as H,u as Y,e as G,V as J}from"./vee-validate.esm-DLd1_EgS.js";import{V as K}from"./VRow-DwvvGPWs.js";import{V}from"./VCol-D10BgHc9.js";import{V as Q}from"./VContainer-BnVQQD_B.js";import"./_commonjsHelpers-Cpj98o6Y.js";const W=i=>(O("data-v-db1788ef"),i=i(),T(),i),X={class:"text-center text"},Z=W(()=>n("h1",{class:"text-center text-red"},"已下架",-1)),ee={__name:"[id]",setup(i){const d=f(!1),m=()=>{const l=window.scrollY,t=80;d.value=l>t};C(()=>{window.addEventListener("scroll",m)}),F(()=>{window.removeEventListener("scroll",m)});const{api:h}=j(),y=z(),x=A(),p=I(),v=E(),e=f({_id:"",name:"",price:0,description:"",image:"",sell:!0,category:""});(async()=>{var l,t;try{const{data:a}=await h.get("/product/"+y.params.id);e.value._id=a.result._id,e.value.name=a.result.name,e.value.price=a.result.price,e.value.description=a.result.description,e.value.image=a.result.image,e.value.sell=a.result.sell,e.value.category=a.result.category,document.title="購物網 | "+e.value.name}catch(a){console.log(a),p({text:((t=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:t.message)||"發生錯誤",snackbarProps:{color:"red"}})}})();const w=D({quantity:H().typeError("數量必填").required("數量必填").min(1,"最少為 1")}),{isSubmitting:_,handleSubmit:S}=Y({validationSchema:w,initialValues:{quantity:1}}),u=G("quantity"),k=S(async l=>{if(!v.isLogin){x.push("/login");return}const t=await v.addCart(e.value._id,l.quantity);p({text:t.text,snackbarProps:{color:t.color}})});return(l,t)=>(M(),B($,null,[n("div",{id:"navbar",class:N({"hidden-navbar":d.value})},null,2),s(Q,{class:"text-black container"},{default:o(()=>[s(K,null,{default:o(()=>[s(V,{cols:"12",md:"6"},{default:o(()=>[s(P,{src:e.value.image,height:"400"},null,8,["src"])]),_:1}),s(V,{cols:"12",md:"6"},{default:o(()=>[n("div",X,[n("h1",null,c(e.value.name),1),n("p",null,c(e.value.description),1),n("p",null,"$"+c(e.value.price),1),s(J,{class:"form",disabled:r(_),onSubmit:R(r(k),["prevent"])},{default:o(()=>[s(L,{type:"number",modelValue:r(u).value.value,"onUpdate:modelValue":t[0]||(t[0]=a=>r(u).value.value=a),modelModifiers:{number:!0},"error-messages":r(u).errorMessage.value},null,8,["modelValue","error-messages"]),s(g,{type:"submit","prepend-icon":"mdi-cart",loading:r(_)},{default:o(()=>[b("加入購物車")]),_:1},8,["loading"])]),_:1},8,["disabled","onSubmit"])])]),_:1})]),_:1})]),_:1}),s(U,{class:"align-center justify-center text-center","model-value":!e.value.sell,persistent:""},{default:o(()=>[Z,s(g,{to:"/"},{default:o(()=>[b("回首頁")]),_:1})]),_:1},8,["model-value"])],64))}},ie=q(ee,[["__scopeId","data-v-db1788ef"]]);export{ie as default};
