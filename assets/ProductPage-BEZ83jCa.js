import{u as P,aY as h,a6 as v,E as m,r as k,o as p,a8 as V,w as t,b as e,V as x,aA as y,ac as i,ae as _,aB as b,aC as S,aX as B,ab as w,R as E,ay as A,a as R,e as T,F as N,aa as D,aD as F,O as I}from"./index-ISHx9GPs.js";import{V as L,a as f}from"./VCol-Bq47OfdI.js";import{V as M}from"./VPagination-DSsgZ_Cu.js";import{V as U}from"./VRow-DUxUzbyq.js";const $={__name:"ProductCard",props:["_id","category","description","image","name","price","sell"],setup(s){const c=P(),g=h(),n=v(),u=s,r=m(!1),d=async()=>{if(!c.isLogin){g.push("/login");return}r.value=!0;const l=await c.addCart(u._id,1);n({text:l.text,snackbarProps:{color:l.color}}),r.value=!1};return(l,o)=>{const a=k("router-link");return p(),V(A,null,{default:t(()=>[e(x,{src:s.image,cover:"",height:"200"},null,8,["src"]),e(y,null,{default:t(()=>[e(a,{to:"/products/"+s._id},{default:t(()=>[i(_(s.name),1)]),_:1},8,["to"])]),_:1}),e(b,null,{default:t(()=>[i("$"+_(s.price),1)]),_:1}),e(S,null,{default:t(()=>[i(_(s.description),1)]),_:1}),e(B,null,{default:t(()=>[e(w),e(E,{color:"primary","prepend-icon":"mdi-cart",onClick:d,loading:r.value},{default:t(()=>[i("加入購物車")]),_:1},8,["loading"])]),_:1})]),_:1})}}},G=D("h1",{class:"text-center"},"線上購物",-1),C=20,q={__name:"ProductPage",setup(s){const{api:c}=F(),g=v(),n=m(1),u=m(1),r=m([]),d=async()=>{var l,o;try{const{data:a}=await c.get("/product",{params:{itemsPerPage:C,page:n.value}});u.value=Math.ceil(a.result.total/C),r.value.splice(0,r.value.length,...a.result.data)}catch(a){console.log(a),g({text:((o=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:o.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return d(),(l,o)=>(p(),V(L,null,{default:t(()=>[e(U,null,{default:t(()=>[e(f,{cols:"12"},{default:t(()=>[G]),_:1}),(p(!0),R(N,null,T(r.value,a=>(p(),V(f,{cols:"12",md:"6",lg:"3",key:a._id},{default:t(()=>[e($,I({ref_for:!0},a),null,16)]),_:2},1024))),128)),e(f,{cols:"12"},{default:t(()=>[e(M,{modelValue:n.value,"onUpdate:modelValue":[o[0]||(o[0]=a=>n.value=a),d],length:u.value,rounded:"circle"},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1}))}};export{q as default};
